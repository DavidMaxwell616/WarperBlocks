<!DOCTYPE html>
<html>

<head>
  <script src="js/phaser.3.18.1.min.js" crossorigin="anonymous"></script>
</head>

<body>
  <script>
    var config = {
      width: 300,
      height: 100,
      type: Phaser.AUTO,
      backgroundColor: '#111111',
      parent: 'phaser-example',
      scene: {
        preload: preload,
        create: create,
        update: update,
      },
    };
    var block = [];

    var game = new Phaser.Game(config);

    function preload() {
      this.load.path = './assets/images/';
      for (let x = 0; x <= 2; x++) {
        for (let y = 0; y <= 2; y++) {
          var blk = this.load.image(
            'block' + x + y,
            'block' + x + y + '.png',
          );
        }
      }
    }

    function create() {
      var width = this.game.config.width;
      var height = this.game.config.height;
      for (let y = 0; y <= 0; y++) {
        for (let x = 0; x <= 2; x++) {
          var blk = this.add
            .image(x * 100, y * 100, 'block' + x + y)
            .setOrigin(0, 0)
            .setInteractive();
          blk.name = 'block' + x + y;
          this.input.setDraggable(blk);
          block.push(blk);
        }
      }

      this.input.on('drag', function (pointer, gameObject, dragX, dragY) {
        var xScale = ((gameObject.x + dragX * 2.5) / width) + 1;
        var yScale = ((gameObject.y + dragY * 2.5) / height) + 1;
        gameObject.setScale(xScale, yScale);

        var w = gameObject.width * xScale;
        var h = gameObject.height * yScale;
        var w2 = (width - w) / 2;
        var h2 = (height - h) / 2;

        for (let index = 0; index < block.length; index++) {
          const blockName = block[index].name;
          const x1 = gameObject.name.substring(blockName.length - 2,
            blockName
            .length - 1);
          const y1 = gameObject.name.substring(blockName.length - 1,
            blockName
            .length);
          const x2 = blockName.substring(blockName.length - 2, blockName
            .length - 1);
          const y2 = blockName.substring(blockName.length - 1, blockName
            .length);
          if (blockName != gameObject.name) {
            let offset = w2 * (x2 - 1);
            console.log(blockName, w, w + offset);
            if (x2 > x1)
              block[index].x = w + offset;
            block[index].setScale(w2, yScale);
          }

        }
        //     for (let y = 0; y <= 0; y++) {
        //       for (let x = 0; x <= 2; x++) {
        //     if (gameObject.name != 'block' + x + y)
        //     block[x].setScale(width - w * x, height - h * y);
        //   }
        // }






        //   block[1].x = w;
        //   block[1].setScale(w2, yScale);
        //   block[2].x = w + w2;
        //   block[2].setScale(w2, yScale);




        // block[3].y = h;
        // block[3].y = gameObject.y + h;
        // block[3].setScale(w2, h2);
        // block[4].y = h;
        // block[4].y = gameObject.y + h;
        // block[4].setScale(w2, h2);
        // block[5].y = h;
        // block[5].y = gameObject.y + h;
        // block[5].setScale(w2, h2);
        // block[6].y = h + h2;
        // block[6].y = gameObject.y + h;
        // block[6].setScale(w2, h2);
        // block[7].y = h + h2;
        // block[7].y = gameObject.y + h;
        // block[7].setScale(w2, h2);
        // block[8].y = h + h2;
        // block[8].y = gameObject.y + h;
        // block[8].setScale(w2, h2);


        //gameObject.x = pointer.x;
        //gameObject.y = pointer.y;
      });
    }

    function update() {}
  </script>
</body>

</html>